<!DOCTYPE html>
<html>
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <!-- Should I remove it? -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-89355375-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-89355375-2');
    </script>
    <style type="text/css">
      body {
        font-family: arial;
      }

      #result {
        width: 80%;
        margin: 100px auto;
        text-align: center;
        font-variant: small-caps;
        font-size: 32px;
        font-family: 'Shadows Into Light Two', cursive;
      }

      .github-link {
        position: absolute;
        color: #ccc;
        right: 10px;
        bottom: 10px;
        font-size: 12px;
        text-decoration: none;
      }
    </style>
    <link href="https://fonts.googleapis.com/css?family=Shadows+Into+Light+Two" rel="stylesheet">
    <script type="text/javascript">
      var template = choice([
        'Você sabia que',
        fork([
          choice([
            'o equinócio de',
            fork(['outono', 'primavera'])
          ]),
          choice([
            fork(['o solstício', 'as olimpíadas']),
            'de',
            fork(['inverno', 'verão']),
          ]),
          choice([
            'o',
            fork(['nascer do sol', 'pôr do sol']),
            fork(['mais cedo', 'mais tarde']),
          ]),
          'o horário de verão',
          choice([
            'o',
            fork(['dia', 'ano']),
            'bissexto',
          ]),
          'a páscoa',
          choice([
            'a',
            fork(['lua cheia', 'super lua', 'lua sangrenta'])
          ]),
          'o mês do toyota truck',
          'a semana dos tubarões',
        ]),
        fork([
          choice([
            'acontece',
            fork(['mais cedo', 'mais tarde', 'na hora errada']),
            'todo ano',
          ]),
          choice([
            'fica fora de sincronização com',
            fork([
              'o sol',
              'a lua',
              'o zodíaco',
              choice([
                'o calendário',
                fork(['gregoriano', 'maia', 'lunar', 'do iphone'])
              ]),
              'o relógio atômico no colorado',
            ]),
          ]),
          choice([
            'pode',
            fork(['não acontecer', 'acontecer duas vezes']),
            'nesse ano',
          ]),
        ]),
        'por causa',
        fork([
          choice([
            'da legislação de fusos horários',
            fork(['em indiana', 'no arizona', 'na russia']),
          ]),
          'de um decreto pelo papa por volta de 1500',
          choice([
            'da',
            fork([
              'precessão',
              'libertação',
              'nutação',
              'libação',
              'excentricidade',
              'obliquidade',
            ]),
            fork([
              'da lua',
              'do sol',
              'do eixo da terra',
              'do equador',
              'do meridiano principal',
              choice([
                'da linha'
                fork(['internacional da data', 'de mason-dixon'])
              ]),
            ])
          ]),
          'da reversão do campo magnético',
          choice([
            'de uma decisão arbritária',
            fork(['por benjamin franklin', 'por isaac newton', 'pela fdr']),
          ]),
        ]),
        "? aparentemente",
        fork([
          'isso provoca um aumento previsível nos acidentes de carro.',
          "é por isso que temos segundos bissextos.",
          'os cientistas estão realmente preocupados.',
          choice([
            'isso foi ainda mais extremo durante',
            fork(['a era do bronze.', 'a era do gelo.', 'o cretáceo.', 'os anos 90.']),
          ]),
          choice([
            'há uma proposta de correção, mas isso',
            fork([
              'nunca irá acontecer.',
              'na verdade só torna as coisas piores.',
              'está parada no congresso.',
              'pode ser inconstitucional.',
            ]),
          ]),
          "está piorando e ninguém sabe o porquê.",
        ]),
        'Embora possa parecer trivial isso',
        fork([
          'provoca enormes dores de cabeça para desenvolvedores de software.',
          'é aproveitado pelos negociadores de alta velocidade.',
          'desencadeou o blackout do nordeste dos EUA em 2003.',
          'tem que ser corrigido pelos satélites GPS.',
          'agora é reconhecido como uma das principais causas da primeira guerra mundial.',
        ]),
      ])

      function fork(choices) {
        return {type: 'fork', members: choices}
      }

      function choice(options) {
        return {type: 'choice', members: options}
      }

      function randomChoice(choices) {
        return choices[Math.floor(Math.random() * choices.length)]
      }

      function process(element) {
        if (element.type === 'fork') {
          return process(randomChoice(element.members))
        } else if (element.type === 'choice') {
          return element.members.map(process).join(' ')
        } else {
          return element
        }
      }

      function regen() {
        document.querySelector('#result').innerText = process(template)
          .replace(' ?', '?')
      }

      document.addEventListener('DOMContentLoaded', regen)
    </script>
  </head>
  <body>
    <a href="https://xkcd.com/1930/">Fonte: xkcd</a>
    <a href="https://staab.github.io/xkcd-1930/">Site original</a> (em inglês)
    &nbsp;
    <button id="regen" onclick="regen()">Gerar</button>
    <div id="result"></div>
    <a class="github-link" href="https://github.com/staab/xkcd-1930">Ver em GitHub</a>
  </body>
</html>
